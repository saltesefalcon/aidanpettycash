rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {

    // ---------- Petty Cash ----------
    // Accept both:
    // pettycash/{storeId}/{fileName}
    // pettycash/{storeId}/{entryId}/{fileName}
    match /pettycash/{storeId}/{rest=**} {
      allow read: if true; // keep as-is (your current behavior)
      allow write: if request.auth != null
                   && request.resource.size < 20 * 1024 * 1024
                   && request.resource.contentType == 'application/pdf';
    }

    // ---------- Transfers ----------
    // Accept:
    // transfers/{YYYY-MM}/{fileName}.pdf
    match /transfers/{rest=**} {
      allow read: if request.auth != null; // managers + admins
      allow write: if request.auth != null
                   && request.resource.size < 20 * 1024 * 1024
                   && request.resource.contentType == 'application/pdf';
    }
  }
}
